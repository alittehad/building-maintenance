<!DOCTYPE html>
<html>
<head>
  <title>Login - Building Maintenance</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <script src="firebase-config.js"></script>
</head>
<body>
  <h2>Login with Google</h2>
  <button onclick="login()">Login</button>

  <script>
    const adminEmails = ["ngogrant454@gmail.com"];

    function login() {
      const provider = new firebase.auth.GoogleAuthProvider();
      firebase.auth().signInWithPopup(provider).then(result => {
        const user = result.user;
        const email = user.email;

        if (adminEmails.includes(email)) {
          window.location.href = "admin.html";
        } else {
          firebase.database().ref("users/" + user.uid).once("value").then(snapshot => {
            const room = snapshot.val()?.room;
            if (room) {
              window.location.href = "room.html?room=" + room;
            } else {
              alert("आपका रूम नंबर असाइन नहीं है। कृपया एडमिन से संपर्क करें।");
            }
          });
        }
      });
    }
  </script>
</body>
</html>
